<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ferramenta para gerar propostas comerciais para im√≥veis da Santa Ilha a partir de um link.">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üè†</text></svg>">
    
    <title>Gerador de Proposta de Im√≥vel - Santa Ilha</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --color-primary: #3d357e;
            --color-primary-hover: #322c6a;
            --color-accent: #edae0f;
            --color-accent-hover: #d49c0d;
            --color-background: #f9fafb;
            --color-surface: #ffffff;
            --color-text-primary: #1f2937;
            --color-text-secondary: #6b7280;
            --color-text-on-accent: #1f2937;
        }
        body { font-family: 'Inter', sans-serif; background-color: var(--color-background); }
        .btn-primary { background-color: var(--color-primary); color: white; transition: background-color 0.3s; }
        .btn-primary:hover { background-color: var(--color-primary-hover); }
        .btn-accent { background-color: var(--color-accent); color: var(--color-text-on-accent); transition: background-color 0.3s; }
        .btn-accent:hover { background-color: var(--color-accent-hover); }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-3xl rounded-2xl shadow-lg bg-white overflow-hidden transition-all duration-500">
        <div class="p-6 text-center" style="background-color: var(--color-surface);">
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASIAAABACAYAAADeH2AAAAF1SURBVHic7d1BTkNBFIXhZ1Iix8ABuAAH4AAdK3SACEgIkZ5U0jS1d+/e2ZzckzSx7v1PZqaJMWOMj/Nk8j55kAAn9S+ATyJAgIBXECAwBwQIEIhfQIDw3SCAAF8QIDAHBAgQiF9AgPDdIIAAXxAgMAcECBCIX0CA8N0ggABfECAwBwQIEIhfQIDw3SCAAF8QIDAHBAgQiF9AgPDdIIAAXxAgMAcECBCIX0CA8N0ggABfECAwBwQIEIhfQIDw3SCAAF8QIDAHBAgQiF9AgPDdIIAAXxAgMAcECBCIX0CA8N0ggABfECAwBwQIEIhfQIDw3SCAAF8QIDAHBAgQiF9AgPDdIIAAXxAgMAcECBCIX0CA8N0ggABfECAwBwQIEIhfQIDw3SCAAF8QIDAHBAgQiF9AgPDdIIAAXxAgMAcECBCIX0CA8N0ggABfECAwBwQIEIhfQIDw3SCAAF8QIDAHBAgQiF9AgPDdIIAAX5CXgA/yMPlJJuOScRmMJOOR8PZ+1g9ZeTsfJSNJ+/YnSYAAvjGvA1+XAR8k45HQ2YyEd+yff0mAAD6SlYAPkpHcZzKScQnZ7L9/TIAAPs9qwLtlwD/8V/4lAQJ8krUAfJKMV/4vCRAgQIAAgXkBAWb2hAYIECBAgAC/goAAmwIBAgQIECDwKwgIsCmQAAECBAgQ+BUFBNAUSETgW+BLAJ8kI/Oq8mUyco+yL79kK8hYyL5kX0aWfY/siwzZ9zWyL/Jk3//JvkyYff9n+zLD9v2fbcsM2fY9ty0zZN/33LbMkH3/d9syQ/b9n23LDNv3P7ctM2Tf/922zJB9//fZskP2/Z9tyww59wNAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBlwS+AbF9c0xKxAtwAAAAAElFTkSuQmCC" alt="Logo Santa Ilha" class="mx-auto h-14 w-auto">
        </div>

        <div class="p-8">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold" style="color: var(--color-text-primary);">Gerador de Proposta de Im√≥vel</h1>
                <p class="mt-2" style="color: var(--color-text-secondary);">Cole o link do im√≥vel para gerar uma proposta comercial otimizada por IA.</p>
            </div>

            <div class="space-y-4">
                <div>
                    <label for="propertyUrl" class="block text-sm font-medium" style="color: var(--color-text-primary);">Link do Im√≥vel</label>
                    <input type="url" id="propertyUrl" value="https://santailha.com.br/imovel/casa-com-2-dormitorios-a-venda-100m2-campeche-florianopolis-sc-67087" class="w-full mt-1 px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus-border-transparent focus:ring-primary transition-all">
                </div>
                <button id="generateBtn" class="w-full flex items-center justify-center font-bold py-3 px-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary btn-primary transform active:scale-95">
                    <span id="btnText">Gerar Proposta</span>
                    <svg id="spinner" class="animate-spin -ml-1 mr-3 h-5 w-5 text-white hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                </button>
            </div>

            <div id="resultContainer" class="mt-8 pt-6 border-t border-gray-200 hidden">
                <h2 class="text-2xl font-bold mb-4" style="color: var(--color-text-primary);">Proposta Gerada</h2>
                <div class="bg-gray-50 p-6 rounded-lg shadow-inner">
                    <pre id="proposalOutput" class="whitespace-pre-wrap text-sm leading-relaxed" style="font-family: 'Inter', sans-serif; color: var(--color-text-primary);"></pre>
                </div>
                 <button id="copyBtn" class="mt-4 w-full flex items-center justify-center font-bold py-3 px-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus-ring-accent btn-accent">
                    Copiar Texto
                </button>
            </div>
        </div>
    </div>

    <textarea id="copyHelper" style="position: absolute; left: -9999px;"></textarea>

    <script>
        const propertyUrlInput = document.getElementById('propertyUrl');
        const generateBtn = document.getElementById('generateBtn');
        const btnText = document.getElementById('btnText');
        const spinner = document.getElementById('spinner');
        const resultContainer = document.getElementById('resultContainer');
        const proposalOutput = document.getElementById('proposalOutput');
        const copyBtn = document.getElementById('copyBtn');
        const copyHelper = document.getElementById('copyHelper');

        generateBtn.addEventListener('click', async () => {
            const url = propertyUrlInput.value;
            setLoading(true);

            try {
                // Nova fun√ß√£o que usa a API em vez de scraping
                const extractedData = await fetchPropertyDataFromAPI(url);
                
                // Esta parte continua a mesma, mas agora recebe dados fi√°veis da API
                const proposalText = generateProposalText(extractedData);
                displayProposal(proposalText);

            } catch (error) {
                console.error("Erro ao processar:", error);
                displayProposal(`Houve um erro ao processar a sua solicita√ß√£o: ${error.message}`);
            } finally {
                setLoading(false);
            }
        });

        function extractPropertyCode(url) {
            try {
                const pathSegments = new URL(url).pathname.split('/');
                // O c√≥digo do im√≥vel geralmente √© o √∫ltimo segmento do URL
                const lastSegment = pathSegments.pop() || pathSegments.pop(); // Lida com barras no final
                const code = lastSegment.split('-').pop(); // Pega a parte num√©rica final, ex: 'sc-67087' -> '67087'
                if (!/^\d+$/.test(code)) {
                    throw new Error("C√≥digo num√©rico n√£o encontrado no final do segmento.");
                }
                return code;
            } catch (e) {
                console.error("N√£o foi poss√≠vel extrair o c√≥digo do im√≥vel do URL:", url);
                throw new Error("O URL do im√≥vel fornecido n√£o parece ser v√°lido.");
            }
        }

        async function fetchPropertyDataFromAPI(url) {
            const propertyCode = extractPropertyCode(url);
            
            // --- SUBSTITUIR COM OS SEUS DADOS REAIS DO VISTA ---
            const VISTA_API_ENDPOINT = `https://api.vista.com.br/v1/imoveis/${propertyCode}`;
            const VISTA_API_KEY = "SUA_CHAVE_DE_API_AQUI"; 
            // ----------------------------------------------------

            console.log(`Buscando dados da API para o c√≥digo: ${propertyCode}`);
            
            // A chamada real √† API seria algo como:
            /*
            const response = await fetch(VISTA_API_ENDPOINT, {
                headers: {
                    'Authorization': `Bearer ${VISTA_API_KEY}`
                }
            });

            if (!response.ok) {
                throw new Error(`Falha ao buscar dados da API. Status: ${response.status}`);
            }
            const apiData = await response.json();
            */

            // --- SIMULA√á√ÉO DA RESPOSTA DA API ---
            // Para fins de demonstra√ß√£o, vamos simular que a API nos retornou os dados.
            // Voc√™ precisar√° mapear os campos da sua API real para este formato.
            console.log("SIMULANDO chamada √† API. Substitua esta sec√ß√£o pela chamada real.");
            await new Promise(resolve => setTimeout(resolve, 1000)); // Simula o tempo de espera da rede
            
            const simulatedApiData = {
                Titulo: "Casa com 2 dormit√≥rios √† venda no Campeche",
                Bairro: "Campeche",
                Cidade: "Florian√≥polis",
                UF: "SC",
                ValorVenda: "980.000",
                AreaTotal: "100",
                Dormitorios: "2",
                Suites: "1",
                Banheiros: "2",
                Vagas: "1",
                DescricaoWeb: "A casa de condom√≠nio est√° localizado no bairro Campeche possui 100 metros quadrados com 2 quartos sendo 1 suite e 2 banheiros. Possui espa√ßo gourmet, jardim, parquinho com diferentes brinquedos. Vai lhe possibilitar curtir os dias mais quentes na piscina. Espa√ßo reservado para preparar o seu churrasco.",
                Caracteristicas: ["Piscina", "Espa√ßo gourmet", "Jardim", "Playground", "Churrasqueira", "Condom√≠nio fechado"]
            };
            // ------------------------------------

            // Mapeamos os dados da API (simulada) para o nosso formato de objeto `propertyData`
            const propertyData = {
                title: simulatedApiData.Titulo,
                location: `${simulatedApiData.Bairro}, ${simulatedApiData.Cidade}, ${simulatedApiData.UF}`,
                price: `R$ ${simulatedApiData.ValorVenda}`,
                description: simulatedApiData.DescricaoWeb,
                mainFeatures: [
                    `${simulatedApiData.AreaTotal}m¬≤`,
                    `${simulatedApiData.Dormitorios} Quartos`,
                    `${simulatedApiData.Suites} Su√≠te`,
                    `${simulatedApiData.Vagas} Vaga(s)`
                ],
                allFeatures: simulatedApiData.Caracteristicas
            };

            console.log("Dados da API mapeados:", propertyData);
            return propertyData;
        }
        
        function generateProposalText(data) {
            const { title, location, price, description, mainFeatures, allFeatures } = data;
            const mainFeaturesText = mainFeatures.join(' | ');

            return `**Assunto:** Oportunidade √önica: ${title}

**Prezado(a) Cliente,**

Espero que este contato o encontre bem.

Gostaria de apresentar uma oportunidade especial que acaba de surgir em nosso portf√≥lio: um(a) **${title}**, localizado(a) em **${location}**.

**Resumo da Propriedade:**
- **Localiza√ß√£o:** ${location}
- **Valor de Investimento:** ${price}
- **Caracter√≠sticas Principais:** ${mainFeaturesText}.

**Descri√ß√£o Detalhada:**
${description}

**Diferenciais do Im√≥vel:**
${allFeatures.map(f => `- ${f}`).join('\n')}

Acreditamos que esta propriedade representa um excelente investimento e um lugar maravilhoso para se viver.

Gostaria de agendar uma visita para que voc√™ possa conhecer pessoalmente?

Atenciosamente,

**[Seu Nome]**
**Santa Ilha Im√≥veis**`;
        }
        
        function setLoading(isLoading) {
            generateBtn.disabled = isLoading;
            btnText.classList.toggle('hidden', isLoading);
            spinner.classList.toggle('hidden', !isLoading);
        }

        function displayProposal(text) {
            proposalOutput.textContent = text.trim();
            resultContainer.classList.remove('hidden');
        }

        copyBtn.addEventListener('click', () => {
            copyHelper.value = proposalOutput.textContent;
            copyHelper.select();
            document.execCommand('copy');
            const originalText = copyBtn.textContent;
            copyBtn.textContent = 'Copiado!';
            setTimeout(() => { copyBtn.textContent = originalText; }, 2000);
        });

    </script>
</body>
</html>
